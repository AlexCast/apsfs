% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/psf_m.R
\name{fit_annular_psf}
\alias{fit_annular_psf}
\title{PSF annular cumulative integral model}
\usage{
fit_annular_psf(psfm, norm = TRUE)
}
\arguments{
\item{psfm}{An object produced by the function \code{mc_psf}.}

\item{norm}{Logical. Should the PSF be normalized to sum to unity?}
}
\value{
A list with the follwoing components: "type": type of the fitted model, 
"coefficients": named vector with the 5 coefficients, and "mare" with the 
value of the mean absolute relative error of the model fit.
}
\description{
Fits an exponential model to the radius cumulative integral of a PSF 
accumulated in annular geometry.
}
\details{
The code calculates the cummulative integral of the annular PSF and fits the 
following model by optimization:

F(r) = c1 - (c2 * e^(c3 * r) + c4 * e^(c5 * r) + c6 * e^(c7 * r)),

where c2 + c4 + c6 = c1.

The cummulative annular integral PSF is as known as "environmental function".
The optimization is made with mean absolute relative error (MARE) as the 
error function.

Note that 'PSF' in this package refers to the diffusely transmitted photons 
only. Photons from direct transmission are not included in the caluclations.
}
